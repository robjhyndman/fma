<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using fma: worked examples • fma</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using fma: worked examples">
<meta property="og:description" content="fma">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/fma-vignette.html">Vignette</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/robjhyndman/fma" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using fma: worked examples</h1>
                        <h4 data-toc-skip class="author">Justin Carmody,
Rob J Hyndman</h4>
            
            <h4 data-toc-skip class="date">2023-02-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/fma/blob/HEAD/vignettes/fma-vignette.Rmd" class="external-link"><code>vignettes/fma-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>fma-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package contains a collection of datasets that are designed to
accompany the textbook “Forecasting: Methods and Applications” by
Makridakis, Wheelwright &amp; Hyndman (Wiley, 3rd ed., 1998). The book
can be purchased <a href="https://www.amazon.com/d/p0471532339/?tag=otexts-20" class="external-link">here</a>.</p>
<p><a href="https://robjhyndman.com/forecasting/" class="external-link"><img src="https://robjhyndman.com/img/fma.jpg"></a></p>
<p>When the <code>fma</code> package is loaded, the
<code>forecast</code> package is also loaded, providing the functions to
fit models and compute forecasts.</p>
<p>This vignette will give a brief introduction to the ways in which the
datasets in the <code>fma</code> package can be analysed using the
<code>forecast</code> package. Most of the figures from Chapter 2 are
reproduced here. The figure numbers used here correspond to figures in
the textbook.</p>
</div>
<div class="section level2">
<h2 id="data-sets">Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h2>
<p>There are a number of data sets that are included in the
<code>fma</code> package, which are referenced in examples throughout
the book. Descriptions of the data sets that are used in this vignette
are included below:</p>
<ul>
<li>
<p><strong>auto</strong> Cross-sectional data for 45 automobiles
from <em>Consumer Reports</em>, April 1990, pp. 235-255. Columns:</p>
<ul>
<li>
<strong>Model</strong>: The name of the automobile</li>
<li>
<strong>Country</strong>: The country of origin of the
automobile</li>
<li>
<strong>Mileage</strong>: The mileage of the automobile (in miles
per gallon)</li>
<li>
<strong>Price</strong>: The price of the car (in $US)</li>
</ul>
</li>
<li><p><strong>beer</strong> Monthly time series data for Australian
beer production (in megalitres) from January 1991 to August
1995.</p></li>
<li><p><strong>elec</strong> Monthly time series data for Australian
electricity production from January 1956 to August 1995 in kWh.</p></li>
<li><p><strong>milk</strong> Monthly time series data for milk
production per cow (in pounds) over a 14 year time period.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="graphical-summaries">Graphical summaries<a class="anchor" aria-label="anchor" href="#graphical-summaries"></a>
</h2>
<p>The single most important thing to do when first exploring the data
is to visualize it through graphs. The basic features of the data,
including patterns and unusual observations, are most easily seen
through graphs. Sometimes graphs also suggest possible explanations for
some of the variation in the data.</p>
<p>Chapter 2 describes three main types of graph that are useful for
forecasting. R code that can be used to reproduce these examples will be
shown below.</p>
<div class="section level4">
<h4 id="time-plots-and-time-series-patterns">Time plots and time series patterns<a class="anchor" aria-label="anchor" href="#time-plots-and-time-series-patterns"></a>
</h4>
<p>For time series data the most obvious graphical form is a <em>time
plot</em> (in which the data are plotted over time). A time plot
immediately reveals any trends over time, any regular seasonal behavior,
and other systematic features of the data.</p>
<p><strong>Figure 2-1</strong> below shows a time plot of the beer data.
This reveals the range of the data and the time at which peaks occur,
the relative size of the peaks and the randomness in the time
series.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beer</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Monthly Australian Beer Production"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Megalitres"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Figure 2-1: Time plot of monthly Australian beer production (megaliters, Ml) from January 1991–August 1995."</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="seasonal-plots">Seasonal plots<a class="anchor" aria-label="anchor" href="#seasonal-plots"></a>
</h4>
<p>For time series data that have seasonal patterns, it is often useful
to also produce a <em>seasonal plot</em>. This consists of the data
plotted against the individuals “seasons” in which the data were
observed. This is something like a time plot except that the data from
each season are overlapped. A seasonal plot enables the underlying
seasonal pattern more obvious, as well as more easily identify
deviations from this pattern. <strong>Figure 2-2</strong> shows a
seasonal plot of the <code>beer</code> data.</p>
<p>This can be done using the <code>ggseasonplot()</code> function from
the <code>forecast</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggseasonplot</span><span class="op">(</span><span class="va">beer</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, year.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Monthly Australian Beer Production'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">'Months'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Megalitres'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">'Figure 2-2: A seasonal plot of the Australian beer production data. Note that production peaks in</span></span>
<span><span class="st">    November and December in preparation for the southern hemisphere summer and is least in winter.'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="scatterplots">Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"></a>
</h4>
<p>Time plots and seasonal plots are not appropriate for cross-sectional
data. Patterns in these data can be readily visualised with
<strong>scatterplots</strong>. Scatterplots help to visualise the
relationships between variables of interest in a data set.
<strong>Figure 2-3</strong> shows a plot of two variables from the
<code>auto</code> data set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mileage</span>, y <span class="op">=</span> <span class="va">Price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Mileage (mpg)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Price ($US)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Price/Mileage Relationship for 45 Automobiles"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">'Figure 2-3: A scatterplot of price versus mileage for the automobile data.'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The <code>auto</code> data also has an additional explanatory
variable <strong>Country</strong>. It is a categorical variable so
cannot be plotted against <strong>Price</strong> in the same way as the
continuous <strong>Mileage</strong> variable. However, we can include
the <strong>Country</strong> information in our scatterplot with a shape
aesthetic. This is displayed in <strong>Figure 2-4</strong> below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mileage</span>, y <span class="op">=</span> <span class="va">Price</span>, shape<span class="op">=</span><span class="va">Country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Mileage (mpg)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Price ($US)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Price/Mileage Relationship for 45 Automobiles"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">'Figure 2-4: A scatterplot showing price, mileage, and the country of origin for the automobile data.'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="numerical-summaries">Numerical summaries<a class="anchor" aria-label="anchor" href="#numerical-summaries"></a>
</h2>
<p>In addition to graphics, it is also helpful to provide numerical
summaries. A summary number for a data set is called a
<em>statistic</em>.</p>
<div class="section level4">
<h4 id="univariate-statistics">Univariate statistics<a class="anchor" aria-label="anchor" href="#univariate-statistics"></a>
</h4>
<p><strong>Table 2-4</strong> shows the computation of some useful
univariate statistics for the <strong>Mileage</strong> variable in the
<code>auto</code> dataset, after filtering the data set to only include
cars from Japan. These statistics are defined and explained in the
textbook. The following code produces these summary statistics:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto_japan</span> <span class="op">&lt;-</span> <span class="va">auto</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">'Japan'</span><span class="op">)</span></span>
<span><span class="va">auto_japan</span></span>
<span><span class="co">#&gt;                            Model Country Mileage Price</span></span>
<span><span class="co">#&gt; 6                   Mazda MPV V6   Japan      19 14944</span></span>
<span><span class="co">#&gt; 7                   Nissan Van 4   Japan      19 14799</span></span>
<span><span class="co">#&gt; 9                Acura Legend V6   Japan      20 24760</span></span>
<span><span class="co">#&gt; 11            Mitsubishi Wagon 4   Japan      20 14929</span></span>
<span><span class="co">#&gt; 12               Nissan Axxess 4   Japan      20 13949</span></span>
<span><span class="co">#&gt; 13           Mitsubishi Sigma V6   Japan      21 17879</span></span>
<span><span class="co">#&gt; 14               Nissan Stanza 4   Japan      21 11650</span></span>
<span><span class="co">#&gt; 16                  Mazda 929 V6   Japan      21 23300</span></span>
<span><span class="co">#&gt; 23              Nissan Maxima V6   Japan      22 17899</span></span>
<span><span class="co">#&gt; 27             Toyota Cressida 6   Japan      23 21498</span></span>
<span><span class="co">#&gt; 29                Nissan 240SX 4   Japan      24 13249</span></span>
<span><span class="co">#&gt; 31               Subaru Loyale 4   Japan      25  9599</span></span>
<span><span class="co">#&gt; 33           Mitsubishi Galant 4   Japan      25 10989</span></span>
<span><span class="co">#&gt; 37        Honda Prelude Si 4WS 4   Japan      27 13945</span></span>
<span><span class="co">#&gt; 38                   Subaru XT 4   Japan      28 13071</span></span>
<span><span class="co">#&gt; 40               Mazda Protege 4   Japan      32  6599</span></span>
<span><span class="co">#&gt; 43          Honda Civic CRX Si 4   Japan      33  9410</span></span>
<span><span class="co">#&gt; 44                Subaru Justy 3   Japan      34  5866</span></span>
<span><span class="co">#&gt; 45               Toyota Tercel 4   Japan      35  6488</span></span></code></pre></div>
<p><strong>Table 2-4</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto_japan</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            median<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Mileage</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>            MSD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Mileage</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>            Variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            Std_Dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       mean median      MAD      MSD Variance  Std_Dev</span></span>
<span><span class="co">#&gt; 1 24.68421     23 4.371191 27.05817  28.5614 5.344287</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bivariate-statistics">Bivariate statistics<a class="anchor" aria-label="anchor" href="#bivariate-statistics"></a>
</h4>
<p>This section introduces the concepts of <strong>covariance</strong>,
<strong>correlation</strong> and <strong>auto-correlation</strong>.
<strong>Table 2-6</strong> below shows the calculation of these
bivariate statistics for the <code>auto</code> data with
<code>Country == "Japan"</code> (the same data used in <strong>Table
2-5</strong>). The variables being considered are <strong>Price</strong>
and <strong>Mileage</strong>. For this section the units of
<strong>Price</strong> will be converted to thousands of dollars.
Calculation of these statistics is given below:</p>
<p><strong>Table 2-6</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto_japan</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Price <span class="op">=</span> <span class="va">Price</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_milage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            mean_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Price</span><span class="op">)</span>,</span>
<span>            sd_mileage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            sd_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Price</span><span class="op">)</span>,</span>
<span>            covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Price</span>, <span class="va">Mileage</span><span class="op">)</span>,</span>
<span>            correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Price</span>, <span class="va">Mileage</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   mean_milage mean_price sd_mileage sd_price covariance correlation</span></span>
<span><span class="co">#&gt; 1    24.68421   13.93805   5.344287 5.400006  -21.00154  -0.7277246</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="autocorrelation">Autocorrelation<a class="anchor" aria-label="anchor" href="#autocorrelation"></a>
</h4>
<p>The covariance and correlation coefficient are statistics that
measure the extent of the linear relationship between two variables and
can be used to identify explanatory relationships. Autocovariance and
autocorrelation are comparable measures that serve the same purpose for
a single time series.</p>
<p>For example, if we compare <span class="math inline">\(Y_t\)</span>
(the observation at time <span class="math inline">\(t\)</span>) with
<span class="math inline">\(Y_{t−1}\)</span> (the observation at time
<span class="math inline">\(t−1\)</span>), then we see how consecutive
observations are related. The observation <span class="math inline">\(Y_{t−1}\)</span> is described as <em>lagged</em>
by one period.</p>
<p>Together the autocorrelations at lags 1, 2, …, make up the
autocorrelation function or <strong>ACF</strong>. It is much easier to
understand the autocorrelations by plotting them against the lag. This
plot is known as a <em>correlogram</em>. <strong>Figure 2-6</strong>
shows the ACF for the beer data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggAcf</span><span class="op">(</span><span class="va">beer</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'ACF of Beer Production'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">'Figure 2-6: The correlogram (or ACF plot) for the beer production data.'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="forecast-accuracy">Forecast accuracy<a class="anchor" aria-label="anchor" href="#forecast-accuracy"></a>
</h2>
<p>In this section of the book, a variety of measures of forecasting (or
modelling) accuracy are defined. Functions from the
<code>forecast</code> package can be used to calculate these accuracy
measures.</p>
<p>The textbook refers to a simple forecasting method called <em>Naive
Forecast 1</em> (NF1) which is used as a benchmark against which to
compare more sophisticated methods. This method uses the most recent
observation available as a forecast. <strong>Table 2-11</strong> shows
NF1 used to forecast the monthly beer production for the year of
1995.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">beer</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1994</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">naive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">accuracy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  ME     RMSE    MAE       MPE     MAPE MASE       ACF1</span></span>
<span><span class="co">#&gt; Training set -3.625 25.28587 22.125 -3.724331 15.88498  NaN -0.3339436</span></span></code></pre></div>
<p>It can be helpful to look at the autocorrelations in forecast errors.
Figure 2.7 shows the forecast errors obtained by applying the NF1 method
to the Australia monthly beer data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beer</span> <span class="op">%&gt;%</span> <span class="fu">naive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">e</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Errors from NF1 forecasts"</span><span class="op">)</span></span>
<span><span class="fu">ggAcf</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 2-7: Top: Forecast errors obtained by applying the NF1 method to the beer data.</span></span>
<span><span class="st">    Bottom: The ACF of the forecast errors."</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="fma-vignette_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="transformations-and-adjustments">Transformations and adjustments<a class="anchor" aria-label="anchor" href="#transformations-and-adjustments"></a>
</h2>
<p>Sometimes adjusting the data will lead to a simpler and more
interpretable forecasting model. This section of the book deals with
three kinds of adjustments. Examples of each are given below:</p>
<div class="section level4">
<h4 id="mathematical-transformations">Mathematical transformations<a class="anchor" aria-label="anchor" href="#mathematical-transformations"></a>
</h4>
<p><strong>Figure 2-10</strong> below shows a plot of the
<code>elec</code> data set.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Australian Monthly Electricity Production"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"million kWh"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Figure 2-10: Monthly Australian electricity production from January 1956 to August 1995.</span></span>
<span><span class="st">       Note the increasing variation as the level of the series increases."</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>This time plot shows that the size of the annual seasonal variation
increases as the level of the series increases. The variation at the
start (towards the left) is about 300 million kWh, while in more recent
years (to the right) the variation exceeds 2500 kWh. A mathematical
transformation is a convenient method for the necessary task of
including this increasing variation into the forecasts for this
data.</p>
<p>One possible transformation is the <em>square root</em> function.
This transform is plotted below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Square Root of Electricity Production"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"sqrt(million kWh)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>So we can see that this transformation has helped in reducing the
variation in the seasonal cycles. This will make the forecasting task
easier than the un-transformed data shown in <strong>Figure
2-10</strong>.</p>
<p>There are a number of other useful transformations. One of the most
common is the logarithm, as it is relatively easy to interpret.
<strong>Section 2/7</strong> of the textbook gives the formulation for
the set of <em>power transformations</em>. The plots below show a
selection of these transformations.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>    `Square root` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">elec</span><span class="op">)</span>,</span>
<span>    `Cube root` <span class="op">=</span> <span class="va">elec</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    `Log` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">elec</span><span class="op">)</span>,</span>
<span>    `Inverse` <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="va">elec</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span>facet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Transformations of the electricity production data"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 2-11: Transformations of the electricity production data."</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="calendar-adjustments">Calendar adjustments<a class="anchor" aria-label="anchor" href="#calendar-adjustments"></a>
</h4>
<p>Some of the variation in a time series may be due to the variation in
the number of days (or trading days) each month. It is a good idea to
adjust for this known source of variation to allow study of other
interesting features.</p>
<p><strong>Month length</strong> can make quite an impact since number
of days in a month can differ by (31-28)/30 = 10%. If this is not
removed, seasonal patterns become hard to interpret. <strong>Section
2/7/2</strong> in the textbook shows how to make this adjustment.</p>
<p><strong>Figure 2-12</strong> shows the <code>milk</code> data set
with and without being adjusted for month length. The simpler pattern
will lead to better forecasts and easier identification of unusual
observations.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>    Milk <span class="op">=</span> <span class="va">milk</span>,</span>
<span>    `Milk per day` <span class="op">=</span> <span class="va">milk</span><span class="op">/</span><span class="fu">monthdays</span><span class="op">(</span><span class="va">milk</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span>facet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Monthly Milk Production per Cow"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Months"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Pounds"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 2-12: Monthly milk production per cow over 14 years.</span></span>
<span><span class="st">    The second graph shows the data adjusted for the length of the month."</span><span class="op">)</span></span></code></pre></div>
<p><img src="fma-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://robjhyndman.com" class="external-link">Rob Hyndman</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
